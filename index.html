<html>
	<head>
		<script src="tokens.js"></script>
		<script src="https://unpkg.com/docx@5.5.0/build/index.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
		<style>
			body {
				margin: auto;
				display: block;
				width: 70%;
				padding-top:50px;
			}
			input[type="submit"] {
				margin-top: 10px;
			}
			h2, h4 {
				margin-block-end: 0.1em;
			}
			div {
				margin-block-end: 0.7em;
			}
			.warn {
				text-align: center;
				color: orange;
				font-weight: 700;
			}
		</style>
		<title>Medium-to-Word File Generator</title>
	</head>
	<body>
		<h2>Medium-to-Word File Generator</h2>
		<h4>How to Use</h4>
		<div>Enter the author's Medium <strong>username</strong> without the preceding commercial-at (e.g., for <a href="https://medium.com/@doroapodeus" target="_blank">this guy</a> the <strong>username</strong> is <code>doroapodeus</code>, as seen in the URL at the top of the browser). If you click <strong>Submit</strong> now, we'll try to create Word documents from <em>all</em> of your articles. If you only need certain ones (or if you have too many images to do them all--see below), you'll need to do them one at a time using the <strong>article title</strong> field. This field is case insensitive, but otherwise needs to be identical to your article's actual title (copy-pasting is probably your best bet).</div>
		<div>After you click <strong>Submit</strong>, the text will disappear from these fields. Within ~10 seconds, your browser should prompt you to save a Word document (with the title of your article as its filename). (And if you're doing more than 1 article, it will keep prompting you, probably faster than you can interact with the popups.) If you <em>don't</em> see any save-as popups, something went wrong. Perhaps you misspelled the author username or the article title, or perhaps we've been <strong>rate-limited</strong>.</div>
		<h4>Rate-Limited Image Use</h4>
		<div>Part of this program is using an API for determining image sizes. That API is rate-limited (15 requests per hour). If this program fails to generate a Word document, it may be that there have been 15 requests already within the past hour; please wait some time and try again, or try with a Medium article that has fewer images.</div>
		<div class="warn">If you see any problems, and you're on this page, you know how to reach me. Let me know as soon as possible so I can resolve them.</div>
		<h4>File Generation Form:</h4>
		<form id="getWordForm">
			<label for="nm">Author Username: </label><input type="text" id="nm" name="nm" /><br />
			<label for="artTtl">Article Title (optional): </label><input type="text" id="artTtl" name="artTtl" /><br />
			<input type="submit" />
		</form>
		<script type="text/javascript" src="generateWord.js"></script>
	</body>
</html>